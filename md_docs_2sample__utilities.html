<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <meta name="generator" content="Doxygen 1.12.0" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Simple Runtime Analyzer: Sample Utilities Module</title>
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <link rel="icon" type="image/svg+xml" href="../img/icon.svg" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
    <script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
    <script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
    <script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
    <script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
    <script type="text/javascript" src="toggle-alternative-theme.js"></script>
    <script type="text/javascript">
        DoxygenAwesomeFragmentCopyButton.init()
        DoxygenAwesomeDarkModeToggle.init()
        DoxygenAwesomeParagraphLink.init()
        DoxygenAwesomeInteractiveToc.init()
        DoxygenAwesomeTabs.init()
    </script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
    <a href="https://github.com/ShineKnightDev/simple-runtime-analyzer" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80"
            viewBox="0 0 250 250" style="top: 0; border: 0; right: 0;"
            aria-hidden="true">
            <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z" />
            <path
                d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
                fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm" />
            <path
                d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
                fill="currentColor" class="octo-body" />
        </svg></a>
    <style>
        .github-corner:hover .octo-arm {
            animation: octocat-wave 560ms ease-in-out
        }
        @keyframes octocat-wave {
            0%,
            100% {
                transform: rotate(0)
            }
            20%,
            60% {
                transform: rotate(-25deg)
            }
            40%,
            80% {
                transform: rotate(10deg)
            }
        }
        @media (max-width:500px) {
            .github-corner:hover .octo-arm {
                animation: none
            }
            .github-corner .octo-arm {
                animation: octocat-wave 560ms ease-in-out
            }
        }
    </style>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
            <table cellspacing="0" cellpadding="0">
                <tbody>
                    <tr style="height: 56px;">
                        <td id="projectlogo"><img alt="Logo" src="logo.svg" /></td>
                        <td id="projectalign" style="padding-left: 0.5em;">
                            <div id="projectname">Simple Runtime Analyzer
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_docs_2sample__utilities.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Sample Utilities Module</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#autotoc_md60">Key Features</a>
  </li>
  <li class="level1">
    <a href="#autotoc_md62">Concepts and Type Requirements</a>
  </li>
  <li class="level1">
    <a href="#autotoc_md64">Core Components</a>
    <ul>
      <li class="level2">
        <a href="#autotoc_md65">SampleSizeConfig Structure</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md66">generate_sizes Function</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md67">generate_samples Function</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md68">serialize_iterable Function</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md69">save_samples Function</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#autotoc_md71">Error Handling</a>
  </li>
  <li class="level1">
    <a href="#autotoc_md73">Integration with Runtime Analyzer</a>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="autotoc_md59"></a></p>
<p>The <b>Sample Utilities Module</b> (<code><a class="el" href="sample__utilities_8hpp_source.html">sample_utilities.hpp</a></code>) provides a set of tools for generating, populating, and serializing test data for performance analysis. It enables the creation of scientifically distributed sample sizes, populates them with data using customizable functions, and exports the results to various file formats.</p>
<h1><a class="anchor" id="autotoc_md60"></a>
Key Features</h1>
<ul>
<li><b>Intelligent Size Generation</b>: Generates logarithmically distributed sample sizes with configurable bias.</li>
<li><b>Type-Safe Data Generation</b>: Uses C++ concepts to ensure type-safe filler functions.</li>
<li><b>Multi-Format Serialization</b>: Supports text, CSV, and JSON output formats.</li>
<li><b>Flexible API</b>: Designed to be highly flexible with support for custom serialization strategies.</li>
<li><b>Automatic Format Detection</b>: Automatically selects the correct serialization format based on the file extension.</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md62"></a>
Concepts and Type Requirements</h1>
<p>The module defines several C++ concepts to enforce type safety and clear requirements for its functions and components.</p>
<ul>
<li><p class="startli"><b><code>StreamInsertable</code></b>: This concept ensures that a type can be inserted into a standard <code>std::ostream</code>.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><span class="keyword">concept </span>StreamInsertable = <span class="keyword">requires</span>(std::ostream&amp; os, <span class="keyword">const</span> T&amp; t) {</div>
<div class="line">    { os &lt;&lt; t } -&gt; std::same_as&lt;std::ostream&amp;&gt;;</div>
<div class="line">};</div>
</div><!-- fragment --></li>
<li><p class="startli"><b><code>FillerFunction</code></b>: This concept validates that a function can populate a <code>std::vector</code> of a specified type.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> F, <span class="keyword">typename</span> T&gt;</div>
<div class="line"><span class="keyword">concept </span>FillerFunction = std::invocable&lt;F, std::vector&lt;T&gt;&amp;, <span class="keywordtype">size_t</span>&gt;;</div>
</div><!-- fragment --></li>
<li><p class="startli"><b><code>SampleSerializer</code></b>: This concept verifies that a serialization function takes a sample and returns a <code>std::string</code>.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> S, <span class="keyword">typename</span> Sample&gt;</div>
<div class="line"><span class="keyword">concept </span>SampleSerializer =</div>
<div class="line">    std::invocable&lt;S, const Sample&amp;&gt; &amp;&amp; std::is_convertible_v&lt;std::invoke_result_t&lt;S, const Sample&amp;&gt;, std::string&gt;;</div>
</div><!-- fragment --></li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md64"></a>
Core Components</h1>
<h2><a class="anchor" id="autotoc_md65"></a>
SampleSizeConfig Structure</h2>
<p>The <code>SampleSizeConfig</code> struct is a simple container used to configure the parameters for generating sample sizes. It allows for rounding and biasing the distribution.</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>SampleSizeConfig</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span> round_to = 100;</div>
<div class="line">    <span class="keywordtype">double</span> bias = 1.0;</div>
<div class="line">};</div>
</div><!-- fragment --><ul>
<li><code>round_to</code>: Rounds the generated sizes to the nearest multiple of this value.</li>
<li><code>bias</code>: A factor that adjusts the distribution curve; a value greater than <code>1.0</code> biases the distribution towards larger sizes, while a value less than <code>1.0</code> biases it towards smaller sizes.</li>
</ul>
<h2><a class="anchor" id="autotoc_md66"></a>
generate_sizes Function</h2>
<p>The <code>generate_sizes</code> function creates a <code>std::vector</code> of scientifically distributed sample sizes, using a logarithmic approach with configurable bias and rounding to ensure a good spread for performance testing.</p>
<div class="fragment"><div class="line">[[nodiscard]] <span class="keyword">inline</span> std::vector&lt;size_t&gt;</div>
<div class="line">generate_sizes(<span class="keywordtype">size_t</span> sample_count, <span class="keywordtype">size_t</span> max_sample_size, <span class="keyword">const</span> SampleSizeConfig&amp; config = {});</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md67"></a>
generate_samples Function</h2>
<p>The <code>generate_samples</code> function creates data samples by populating containers based on the sizes generated by <code>generate_sizes</code>. It accepts a <b>filler function</b> which is responsible for adding data to each sample.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, detail::FillerFunction&lt;T&gt; F&gt;</div>
<div class="line">[[nodiscard]] std::vector&lt;std::vector&lt;T&gt;&gt; generate_samples(F&amp;&amp; filler, <span class="keyword">const</span> std::vector&lt;size_t&gt;&amp; sizes);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md68"></a>
serialize_iterable Function</h2>
<p>This utility function is a default serializer for iterables that can be inserted into a stream. It formats the data as a string.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;std::ranges::range Iterable&gt;</div>
<div class="line"><span class="keyword">requires</span> detail::StreamInsertable&lt;std::ranges::range_value_t&lt;Iterable&gt;&gt;</div>
<div class="line">[[nodiscard]] std::string serialize_iterable(<span class="keyword">const</span> Iterable&amp; container);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md69"></a>
save_samples Function</h2>
<p>The <code>save_samples</code> function exports the generated data samples to a file. It automatically determines the output format based on the file extension (<code>.txt</code>, <code>.csv</code>, <code>.json</code>) and uses a custom serializer to handle the data format.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;std::ranges::range Container, detail::SampleSerializer&lt;std::ranges::range_value_t&lt;Container&gt;&gt; Serializer&gt;</div>
<div class="line"><span class="keywordtype">void</span> save_samples(<span class="keyword">const</span> Container&amp; samples, Serializer&amp;&amp; serializer, <span class="keyword">const</span> std::filesystem::path&amp; filename);</div>
</div><!-- fragment --><p>There is also a convenience overload that automatically uses <code>serialize_iterable</code> for stream-insertable types.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;std::ranges::range Container&gt;</div>
<div class="line"><span class="keyword">requires</span> detail::StreamInsertable&lt;std::ranges::range_value_t&lt;Container&gt;&gt;</div>
<div class="line"><span class="keywordtype">void</span> save_samples(<span class="keyword">const</span> Container&amp; samples, <span class="keyword">const</span> std::filesystem::path&amp; filename)</div>
<div class="line">{</div>
<div class="line">    save_samples(samples, serialize_iterable&lt;Container&gt;, filename);</div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md71"></a>
Error Handling</h1>
<p>The module provides explicit error handling for common issues:</p>
<ul>
<li><b>File Errors</b>: Throws <code>std::runtime_error</code> if a file cannot be opened.</li>
<li><b>Unsupported Formats</b>: Throws <code>std::runtime_error</code> for unknown file extensions.</li>
<li><b>Empty Containers</b>: Handles empty ranges gracefully during serialization.</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md73"></a>
Integration with Runtime Analyzer</h1>
<p>The <b>Sample Utilities Module</b> is designed to work seamlessly with the <b>Runtime Analyzer</b> and <b>Runtime Reporter</b> modules, forming a complete performance analysis workflow.</p>
<div class="fragment"><div class="line"><span class="comment">// Generate test data with a specific configuration</span></div>
<div class="line"><span class="keyword">auto</span> sizes = <a class="code hl_function" href="namespacesra.html#a636c7020021399862cb9b914db7a44ad">sra::generate_sizes</a>(20, 500000, {.round_to = 250, .bias = 1.3});</div>
<div class="line"><span class="keyword">auto</span> samples = <a class="code hl_function" href="namespacesra.html#a613707bfc02178e734daf179a715234b">sra::generate_samples&lt;int&gt;</a>(fill_with_random_ints, sizes);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Profile the performance of a function using the generated samples</span></div>
<div class="line"><span class="keyword">auto</span> profile = <a class="code hl_function" href="namespacesra.html#a2bade93579f9e53e441905f4483d4b56">sra::profile_runtime</a>(sort_algorithm, samples);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Save both the samples and the profiling results to files</span></div>
<div class="line"><a class="code hl_function" href="namespacesra.html#a966045601b1804ced230cd02a273946b">sra::save_samples</a>(samples, <span class="stringliteral">&quot;sorting_samples.json&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="namespacesra.html#a406737570dd13ef8b60ca8b82bbf4424">sra::save_reports</a>(profile, <span class="stringliteral">&quot;sorting_performance&quot;</span>);</div>
<div class="ttc" id="anamespacesra_html_a2bade93579f9e53e441905f4483d4b56"><div class="ttname"><a href="namespacesra.html#a2bade93579f9e53e441905f4483d4b56">sra::profile_runtime</a></div><div class="ttdeci">auto profile_runtime(Func &amp;&amp;func, const Container &amp;samples, Args &amp;&amp;... args)</div><div class="ttdef"><b>Definition</b> runtime_analyzer.hpp:122</div></div>
<div class="ttc" id="anamespacesra_html_a406737570dd13ef8b60ca8b82bbf4424"><div class="ttname"><a href="namespacesra.html#a406737570dd13ef8b60ca8b82bbf4424">sra::save_reports</a></div><div class="ttdeci">void save_reports(const RuntimeProfile&lt; Unit &gt; &amp;runtime_profile, const std::string &amp;base_filename=&quot;runtime_report&quot;)</div><div class="ttdef"><b>Definition</b> runtime_reporter.hpp:106</div></div>
<div class="ttc" id="anamespacesra_html_a613707bfc02178e734daf179a715234b"><div class="ttname"><a href="namespacesra.html#a613707bfc02178e734daf179a715234b">sra::generate_samples</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; T &gt; &gt; generate_samples(F &amp;&amp;filler, const std::vector&lt; size_t &gt; &amp;sizes)</div><div class="ttdef"><b>Definition</b> sample_utilities.hpp:159</div></div>
<div class="ttc" id="anamespacesra_html_a636c7020021399862cb9b914db7a44ad"><div class="ttname"><a href="namespacesra.html#a636c7020021399862cb9b914db7a44ad">sra::generate_sizes</a></div><div class="ttdeci">std::vector&lt; size_t &gt; generate_sizes(size_t sample_count, size_t max_sample_size, const SampleSizeConfig &amp;config={})</div><div class="ttdef"><b>Definition</b> sample_utilities.hpp:92</div></div>
<div class="ttc" id="anamespacesra_html_a966045601b1804ced230cd02a273946b"><div class="ttname"><a href="namespacesra.html#a966045601b1804ced230cd02a273946b">sra::save_samples</a></div><div class="ttdeci">void save_samples(const Container &amp;samples, Serializer &amp;&amp;serializer, const std::filesystem::path &amp;filename)</div><div class="ttdef"><b>Definition</b> sample_utilities.hpp:190</div></div>
</div><!-- fragment --><div class="section_buttons"></div><div class="section_buttons"><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Previous   </th><th class="markdownTableHeadRight">Next    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><a class="el" href="md_docs_2runtime__reporter.html">Runtime Reporter Module</a>   </td><td class="markdownTableBodyRight"><a class="el" href="md_docs_2plot__generation.html">Plot Generation Script</a>   </td></tr>
</table>
</div><div class="section_buttons"></div> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
